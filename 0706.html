<!doctype html>
<html>
<head>
<meta charset="uft8">
<title>無標題文件</title>
<script type="text/javascript">
var src = 'http://www.payeasy.com.tw/pezlib/study/0302.html';
$("body").append("<iframe id='global-auth-frame' style='display:none' src='" + src + "'></iframe>");

function getStoreKey(domain) {
    return `crossDomainStore::${ domain }`;
}
function readStore(domain) {
    let key = getStoreKey(domain);
    let store = window.localStorage.getItem(key);
    return store ? JSON.parse(store) : {};
}
function writeStore(domain, store) {
    let key = getStoreKey(domain);
    let serializedData = JSON.stringify(store);
    window.localStorage.setItem(key, serializedData);
}

postRobot.on（'read'，{domain：'*'}，（{origin，data}）=> { 
    let store = readStore（origin）; 
    return {result：store [data.key]}; 
}）;
postRobot.on（'write'，{domain：'*'}，（{origin，data}）=> { 
    let store = readStore（origin）; 
    store [data.key] = data.value; 
    writeStore（origin，store） ）; 
}）;

let userStore = Store(window.top);
await userStore.set('user', { name: 'Kermit' });
// later...
console.log(`Hello ${ (await userStore.get('user')).name }!`);
</script>


</head>
<body>


</body>
</html>